おはようございます。Fzok4234 です。


さて、.hmbook ファイルに書式を拡張して
　1. 項目ファイルの文字コード、改行コード、及び BOM の有無。
　2. 項目ファイルを読み取り専用で開くオプション ( /b 、/r 、/bb 、及び /rr ) 。
を明示的に指定できるようにする機能追加を行ってもらいたいのですが、可能でしょうか ?

上記 1. については、項目ファイルの拡張子が同じでも文字コード等が異なる場合等に
「ファイルタイプ別の設定」->「保存・読込」->「エンコードの種類の指定」の設定だけでは
対応しきれず、特にファイルの内容がほとんど ASCII 文字で SHIFT-JIS / BOM 無し UTF-8
/ 欧文 等の判別が困難になるケースでは各項目ファイルごとに明示的に文字コード等を
指定する必要性が存在します。また、2. については主に編集対象のソースコードからなる
プロジェクトの .hmbook ファイルに、参考資料として閲覧専用で開きたい別のソースコードの
項目を追加しておく必要があるためです。

詳しい経緯については
https://www.maruo.co.jp/hidesoft/4/x10179_.html
でのやり取りで述べられている通りですが、現状では上記のことを実現しようとすると、
各項目ファイルのパスに mac: で始まるマクロを挟まないといけません。しかし、これを行うと
　1. 各項目ファイルの右クリックメニューに「コンテキストメニュー(X)」の項目が出て
　   こないので、項目ファイル固有のコマンドを呼び出せない。
　2. 各項目ファイルをマクロから openfile 文で開くため、「ファイルを開いた直後」や
　   「新規作成直後」の自動起動マクロが実行されない。
という問題が発生してしまいます。

このため、マクロを挟まずに通常のパスの登録を行う必要があるのですが、現状では上記の
機能に対応していないため、.hmbook ファイルの書式自体の機能拡張をお願いした次第であります。
どうかよろしくお願い致します。


