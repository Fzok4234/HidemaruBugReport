> V9.25β4は、/から始まる場合をフルパスとして再構成しなくなっただけになっています。
> その後の記述はファイル名だったり他のオプションだったりいろいろ考えられ、１つの
> ファイルとして解釈はしていないです。
> /から始まるのはやってみたらできただけということもありますが、プロジェクトファイルからの
> 相対でもなく、当初の目的もできないので、マクロでやったほうがいいのではないかと思います。

やはり、
https://github.com/Fzok4234/HidemaruMacro/blob/master/OpenProjectItem/src/OpenProjectItem.mac
のようなマクロを挟んだ方がよいとのことですが、この場合の
　1. 「ファイルを開いた直後」、「新規作成直後」及び「アクティブ切り替え後」に対応する
　   自動起動マクロを、呼び出された側での event 及び geteventparam() の値が考慮されるように
　   手動で起動させること。
　2. 項目の右クリックメニューを、任意のパスに対応するコンテキストメニューを追加するなどの
　   カスタマイズを行うこと。
　3. 項目のアイコンを任意の拡張子に対応したものに差し替えること。
を実現させるために、OpenProjectItem.mac に追加する必要のあるマクロの実装方法が思いつかずに
困っている状態です。

具体的な実装のサンプルをご教示いただければ大変助かります。


> 拡張子の判断は実際のファイルの存在を見に行くと時間がかかるので、単純に文字列として最後の
> ものを見ていました。
> しいて合わせるとしたら、ファイル名だけの記述以外のすべては、一律に拡張子を見ないことで、
> 本来は見ないほうがいいです。
> でもせっかくなので残しておいてもいい気がします。
> 単純な文字列の判断を残しておくと、以下のようなものが拡張子アイコンで判断できたりしました。
> /xtest.mac /a"Param1" /aParam2dummy.txt
> mac:openfile "test.txt";//.txt
> mac:"test.mac" Param1 Param2dummy.txt

確かに、
mac:"aaa.mac" bbb.cmd
ではちゃんとバッチファイルのアイコンになりますが、
mac:"aaa.mac" "bbb ccc\ddd eee\fff ggg.cmd"
だと拡張子が認識されずにデフォルトアイコンになってしまいました。

パスがダブルクォーテーションで囲われたために末尾が
.cmd"
のようになっている場合でもちゃんと拡張子を抽出できるように改良した方がよいと思います。


どうかよろしくお願いします。


